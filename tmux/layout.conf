# Pane layout configuration and hooks
# vim: set ft=tmux:

# -----------------------------------------------------------
# Auto split at RATIO when a wide screen is detected

# Minimum window width (in characters) to trigger auto-split or allow re-adjustment
# note: this config var is also used in re-layouting script
set -g @wide_layout_split_threshold 240

# Left column width percentage (0 to 100)
# Example: 36 means left pane gets 36% of width, right gets 64%
# note: this config var is also used in re-layouting script
set -g @wide_layout_split_ratio 36 # in %

# ---- IMPL ----
# Calculate the right pane percentage (Equivalent formula: `100 - left percentage`)
# Example: if ratio is 36 (36% left), right pane percent should be 64%
set -g @__wide_layout_right_pane_percent "#{e|-:100,#{@wide_layout_split_ratio}}"

# Calculate the right pane size based on config
# Equivalent formula: `(pane_width * right_percent) / 100` (integer division)
# Example: if ratio is 36 (36% left), right pane should be 64%
set -g @__wide_layout_right_pane_size "#{e|/:#{e|*:#{pane_width},#{E:@__wide_layout_right_pane_percent}},100}"

# Hook: Automatically splits new windows when wide enough, at a configured ratio
# note: Focus moves to the right (larger) pane after split.
set-hook -g after-new-window {
  if -F "#{>:#{pane_width},#{@wide_layout_split_threshold}}" {
    split-window -h -l "#{E:@__wide_layout_right_pane_size}"
    display-message -d 500 "Auto-split applied (wide screen detected)" # (short display time)
  }
}

# -----------------------------------------------------------
if -F "#{==:#{@tmux_config_status},reloading}" {
  display-message "Tmux layout config and hooks loaded!"
}
