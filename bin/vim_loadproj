#!/bin/sh

file_tmp="/tmp/$$_workspacevim"

SUCCESS=1

function append
{
	[[ -f $1 ]] && echo $2 $1 && SUCCESS=1
	[[ -f $1 ]] || SUCCESS=0
}

function load_project
{
	cmd=edit
	for file_cpp in `ls -t *.cpp`; do

		file_noext=$(sed -e "s/.cpp$//" <<<$file_cpp)

		cmd=edit
		append "$file_noext.h" "$cmd"
		[[ $SUCCESS -eq 1 ]] && cmd=vsplit
		append "$file_noext.hh" "$cmd"
		[[ $SUCCESS -eq 1 ]] && cmd=vsplit
		append "$file_noext.hpp" "$cmd"
		[[ $SUCCESS -eq 1 ]] && cmd=vsplit

		append "$file_cpp" "$cmd"

		cmd=tabnew
		echo "$cmd"
	done
	echo "tabfirst"
}

load_project > $file_tmp

vim -X -S $file_tmp
#rm $file_tmp

