#!/bin/env zsh

autoload -U colors && colors

utc_date=`timedatectl | grep UTC | cut -d ':' -f 2- | cut -d ' ' -f 2- | rev | cut -d ' ' -f 2- | rev`

echo -n "Changing the date to "
echo -n "$fg[cyan]"
echo -n "'$utc_date'"
echo -n "$reset_color"
echo -n " [y/N]:"
echo -n "$fg[yellow]"

read confirm

echo -n "$reset_color"

function cancel()
{
	echo -n "$fg_bold[red]"
	echo -n "Canceled"
	echo "$reset_color"
	exit 1
}

function do_it()
{
	echo
	echo -n "$fg[red]"
	sudo date --set $1
	ret=$?
	echo "$reset_color"
}

case $confirm in
	y|Y) do_it $utc_date;;
	*) cancel;;
esac

echo -n "$fg_bold[yellow]"
if [[ $ret == 0 ]]; then
	echo -n "Date changed successfully"
else
	echo -n "Error when setting the new date"
fi
echo "$reset_color"
